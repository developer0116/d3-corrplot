<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>d3-corrplot Example</title>

  <script src="../bower_components/d3/d3.min.js"></script>
  <script src="../bower_components/d3.chart/d3.chart.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3-tip/0.6.3/d3-tip.min.js"></script>
  <script src="../dist/d3-corrplot.js"></script>

  <link rel="stylesheet" href="//rawgithub.com/Caged/d3-tip/master/examples/example-styles.css">
  <style>
    body {
      overflow: hidden;
      margin: 0;
      font: 14px "Helvetica Neue";
      padding-left: 80px;
    }

    line {
      stroke: black;
    }
  </style>
</head>
<body>
<p>Dataset: <select id="dataset">
  <option value="mtcars.json">mtcars</option>
  <option value="movies.json">movies</option>
</select>
</p>
<p>Order: <select id="order">
  <option value="original">Original</option>
  <option value="name">by Name</option>
  <option value="aoe">AOE</option>
  <option value="fpc">FPC</option>
</select>
</p>

<script language="javascript">
  var Order = new Corrplot.Order();
  var orders = {};

  var vis = d3.select('body').append('svg');
  /* Initialize tooltip */
  tip = d3.tip().attr('class', 'd3-tip').html(function(d) {
    return d.z;
  });
  vis.call(tip);
  /* Invoke the tip in the context of your visualization */
  var corrplot =  vis
      .chart('corrplot')
      .duration(1000)
      .mouseover(tip.show)
      .mouseout(tip.hide);

  d3.select("#order").on("change", function () {
    corrplot.order(orders[this.value]);
  });

  function load(dataset) {
    d3.json('data/' + dataset, function (data) {
      var matrix = data.matrix,
          nodes = data.nodes;

      // Precompute the orders.
      orders = {
        original: Order.Original(nodes),
        name: Order.Alphabetical(nodes, function(d) { return d.name; }),
        aoe: Order.AOE(matrix),
        fpc: Order.FPC(matrix)
      };

      corrplot.drawAndSave(data)
          .order(orders[d3.select('#order').node().value]);
    });
  }

  d3.select("#dataset").on("change", function () {
    load(this.value);
  });
  load('mtcars.json');

  window.addEventListener("resize", function() {
    corrplot.width(Math.min(720, d3.select('body').node().getBoundingClientRect().width - 160));
  });

</script>
</body>
</html>